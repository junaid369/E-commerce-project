<!-- form -->

<div class="container " style="margin-top: 10rem;">
	<div class="row">
		{{#each address}}
		<div class="col-sm-6 mb-3">
			<div class="card">
				<div class="card-body">
					<h5 class="card-title">{{this.firstName}} {{this.lastName}}</h5>
					<p class="card-text">{{this.House}},{{this.Town}} -
						{{this.PIN}},',{{this.House}},{{this.Street}},{{this.Town}}<br></p>
					<button class="btn btn-success"
						onclick="autoFill('{{this.FirstName}}','{{this.LastName}}','{{this.House}}','{{this.Street}}','{{this.Town}}','{{this.PIN}}')">Auto
						Fill</button>
				</div>
			</div>
		</div>
		{{/each}}
		<div class="col-sm-6	 mb-5">
			<div class="card">
				<div class="card-body">

					<a href="/add-new-add" class="btn btn-success">Add New Address</a>
				</div>
			</div>
		</div>
	</div>
	<form id="checkout-form" method="post">
		<div class="row ">

			<div class="col-md-8 ">
				<h4 class="mb-3">Billing address</h4>


				<div class="row ">
					<div class="col-md-6">
						<label for="FirstName" style="color: black; font-weight: 500;">First name</label>
						<input type="text" class="form-control" id="firstName" name="FirstName" placeholder="" value="">

					</div>
					<div class="col-md-6">
						<label for="LastName" style="color: black; font-weight: 500;">Last name</label>
						<input type="text" class="form-control" id="LastName" name="LastName" placeholder="" value="">
					</div>
				</div>


				<div class="mb-3">
					<label for="House" style="color: black; font-weight: 500;">House Name</label>
					<div class="input-group">

						<input type="text" class="form-control" id="House" name="House" placeholder="Username">
						<div class="invalid-feedback" style="width: 100%;">
							Your House is required.
						</div>
					</div>
				</div>

				<div class="mb-3">
					<label for="email" style="color: black; font-weight: 500;">Street <span
							class="text-muted">(Optional)</span></label>
					<input type="text" class="form-control" id="Street" name="Street" placeholder="">
					<div class="invalid-feedback">
						Please enter a valid Street address for shipping updates.
					</div>
				</div>

				<div class="mb-3">
					<label for="address" style="color: black; font-weight: 800;">Town</label>
					<input type="text" class="form-control" id="Town" name="Town" placeholder="1234 Main St">
					<div class="invalid-feedback">
						Please enter your shipping address.
					</div>
				</div>


				<div class="row">
					<div class="col-md-6 mb-3">
						<label for="Mobile" style="color: black; font-weight: 500;">Mobile</label>
						<input type="number" class="form-control" id="Mobile" name="Mobile" placeholder="">
						<div class="invalid-feedback">
							Mobile Number is required
						</div>
					</div>
					<div class="col-md-6 mb-3">
						<label for="zip" style="color: black; font-weight: 500;">PIN</label>
						<input type="number" class="form-control" id="PIN" name="PIN" placeholder="">
						<div class="invalid-feedback">
							PIN code required.
						</div>
					</div>
					<div class="d-block my-3">
						<div class="custom-control custom-radio">
							<input id="User" name="User" type="text" value="{{user._id}}" class="custom-control-input"
								hidden>


						</div>

					</div>
				</div>
				<hr class="mb-4">






				<hr class="mb-4">
				<button id="submit" class="btn btn-primary btn-lg btn-block" type="submit">Continue to
					checkout</button>

			</div>




			<div class="col-md-4 mt-4 ">

				<h4 class="text-muted">Payment Options</h4>


				<div class="custom-control custom-radio ml-3 mt-3">
					<input type="radio" class="custom-control-input" value="COD" id="defaultGroupExample1"
						name="payment">
					<label class="custom-control-label" for="defaultGroupExample1"
						style="color: black; font-weight: 500;">Cash on Delivery</label>
				</div>

				<!-- Group of default radios - option 2 -->
				<div class="custom-control custom-radio mt-4 ml-3">
					<input type="radio" class="custom-control-input" value="Razorpay" id="defaultGroupExample2"
						name="payment" checked>
					<label class="custom-control-label" for="defaultGroupExample2"
						style="color: black; font-weight: 500;">Razor Pay</label>
				</div>

				<!-- Group of default radios - option 3 -->
				<div class="custom-control custom-radio mt-4 ml-3">
					<input type="radio" class="custom-control-input" value="paypal" id="defaultGroupExample3"
						name="payment">
					<label class="custom-control-label" for="defaultGroupExample3"
						style="color: black; font-weight: 500;">PayPal</label>
				</div>




				<h4 class="d-flex justify-content-between align-items-center mb-3">
					<span class="text-muted mt-3">Your cart</span>

					<span class="badge badge-secondary badge-pill">{{cartCount}}</span>
				</h4>
				<ul class="list-group mb-3">
					<li class="list-group-item d-flex justify-content-between lh-condensed">
						<div>
							<h6 class="my-0">{{product.Name}}</h6>
							<small class="text-muted">Brief description</small>
						</div>
						<span class="text-muted">Rs:{{product.Price}}</span>
					</li>

					<li class="list-group-item d-flex justify-content-between">
						<span>Total (INR)</span>

						<strong>Rs:{{total}}</strong>
					</li>
				</ul>




				{{!-- COUPON --}}
				<div class="your-order-bottom">
					<div class="discount-code">
						<p>Enter your coupon code if you have one.</p>
						<input type="text" class="form-control" name="Coupon" id="couponInput" />
						<input type="text" id="couponTotal" name="Total" value="{{total}}" hidden>
						<a id="couponBtn" onclick="couponApply()" class="btn bg-success text-white text-center  mt-2"
							style="width: 100%;text-decoration: none;">Apply
							Coupon</a>
						{{!-- Error handling --}}
						<div class="mt-2">
							<div class="alert alert-danger" style="display: none; " id="couponUsed" role="alert">
								This Coupon has
								been Used
							</div>

							<div class="alert alert-danger" style="display: none;" id="couponUsed" role="alert">
								This Coupon is
								invalid
							</div>

							<div class="alert alert-success" style="display: none;" id="couponSuccess" role="alert">
								Coupon Applied
								Successfully
							</div>

							<div class="alert alert-warning" style="display: none;" id="couponExpired" role="alert">
								Sorry!!! Your
								Coupon has been Expired
							</div>
						</div>


						{{!-- Error ends --}}
					</div>
				</div>

				<div class="your-order-total">
					<table class="table borderless">
						<tr>
							<th>Total</th>
							<td id="totalOriginal">{{total}}</td>
						</tr>
						<tr>
							<th id="discountLabel" style="display: none;">Coupon
								discount</th>
							<td id="discount" style="display: none;" name="Discount"></td>
						</tr>

					</table>

				</div>
				{{!-- /END COUPON --}}



			</div>


		</div>
	</form>
</div>

</div>

</div>





<!-- form -->






// let id = req.session.user._id

// product = await userHelper.buyproduct(ide)

// userHelper.buyOrder(req.body, product, product.PPrice).then((response) => {
//   response.orderId = response.insertedId.toString()
//   req.session.orderId = response.insertedId.toString()

//   let orderId = req.session.orderId
//   console.log(req.session.orderId, "order id");

//   console.log(req.body, "cat show");
//   if (req.body['payment'] == 'COD') {
//     res.json({ codSuccess: true })
//   } else if (req.body['payment'] == 'Razorpay') {
//     userHelper.generateRazorpay(req.session.orderId, product.PPrice).then((response) => {
//       console.log("res", response);

//       response.razorpay = true
//       res.json(response)

//     })

//   }

//   else {



	<!-- forget otp -->
	router.post('/change-password',verifyUserLogin, (req, res) => {
		let id = req.session.user._id
		let pass1 = req.body.password1
		let pass2 = req.body.password2
	  
		if (pass1 == pass2) {
		  userHelper.changePassword(id, req.body).then((response) => {
			req.session.userLoggedIn = false
			req.session.user = null
			res.redirect('/login')
		  })
		} else {
		  req.session.notSame = true
	  
		  res.redirect('/recoverpassword')
		}
	  })
	  
	  